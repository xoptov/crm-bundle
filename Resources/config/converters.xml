<?xml version="1.0" encoding="UTF-8" ?>
<container xmlns="http://symfony.com/schema/dic/services"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

    <parameters>

        <parameter key="perfico_crm.entity_alias.activity" type="string">PerficoCRMBundle:Activity</parameter>

        <parameter key="perfico_crm.entity_alias.channel" type="string">PerficoCRMBundle:Channel</parameter>

        <parameter key="perfico_crm.entity_alias.client" type="string">PerficoCRMBundle:Client</parameter>

        <parameter key="perfico_crm.entity_alias.company" type="string">PerficoCRMBundle:Company</parameter>

        <parameter key="perfico_crm.entity_alias.deal" type="string">PerficoCRMBundle:Deal</parameter>

        <parameter key="perfico_crm.entity_alias.deal_state" type="string">PerficoCRMBundle:DealSate</parameter>

        <parameter key="perfico_crm.entity_alias.payment" type="string">PerficoCRMBundle:Payment</parameter>

        <parameter key="perfico_crm.entity_alias.phone" type="string">PerficoCRMBundle:Phone</parameter>

        <parameter key="perfico_crm.entity_alias.product" type="string">PerficoCRMBundle:Product</parameter>

        <parameter key="perfico_crm.entity_alias.tag" type="string">PerficoCRMBundle:Tag</parameter>

        <parameter key="perfico_crm.entity_alias.user" type="string">PerficoCRMBundle:User</parameter>

        <parameter key="perfico_crm.entity_alias.group" type="string">PerficoCRMBundle:Group</parameter>

    </parameters>

    <services>

        <service id="perfico_crm.api.error_converter" class="Perfico\CRMBundle\Transformer\ErrorConverter">
            <argument type="service" id="validator"/>
        </service>

        <service id="perfico_crm.api.entity_converter" class="Perfico\CRMBundle\Transformer\Converter\AbstractEntityConverter" abstract="true">
            <argument type="service" id="doctrine.orm.default_entity_manager"/>
        </service>

        <service id="perfico_crm.api.channel_converter" class="Perfico\CRMBundle\Transformer\Converter\ChannelConverter" parent="perfico_crm.api.entity_converter">
            <call method="setEntityClass">
                <argument type="string">%perfico_crm.entity_alias.channel%</argument>
            </call>
        </service>

        <service id="perfico_crm.api.client_converter" class="Perfico\CRMBundle\Transformer\Converter\ClientConverter" parent="perfico_crm.api.entity_converter">
            <call method="setEntityClass">
                <argument type="string">%perfico_crm.entity_alias.client%</argument>
            </call>
        </service>

        <service id="perfico_crm.api.clients_list_statuses_converter" class="Perfico\CRMBundle\Transformer\Converter\ClientsListDealStatesConverter" parent="perfico_crm.api.entity_converter">
            <call method="setEntityClass">
                <argument type="string">%perfico_crm.entity_alias.deal%</argument>
            </call>
        </service>

        <service id="perfico_crm.api.deal_converter" class="Perfico\CRMBundle\Transformer\Converter\DealConverter" parent="perfico_crm.api.entity_converter">
            <call method="setEntityClass">
                <argument type="string">%perfico_crm.entity_alias.deal%</argument>
            </call>
        </service>

        <service id="perfico_crm.api.deal_state_converter" class="Perfico\CRMBundle\Transformer\Converter\DealStateConverter" parent="perfico_crm.api.entity_converter">
            <call method="setEntityClass">
                <argument type="string">%perfico_crm.entity_alias.deal_state%</argument>
            </call>
        </service>

        <service id="perfico_crm.api.company_converter" class="Perfico\CRMBundle\Transformer\Converter\CompanyConverter" parent="perfico_crm.api.entity_converter">
            <call method="setEntityClass">
                <argument type="string">%perfico_crm.entity_alias.company%</argument>
            </call>
        </service>

        <service id="perfico_crm.api.tag_converter" class="Perfico\CRMBundle\Transformer\Converter\TagConverter" parent="perfico_crm.api.entity_converter">
            <call method="setEntityClass">
                <argument type="string">%perfico_crm.entity_alias.tag%</argument>
            </call>
        </service>

        <service id="perfico_crm.api.product_converter" class="Perfico\CRMBundle\Transformer\Converter\ProductConverter" parent="perfico_crm.api.entity_converter">
            <call method="setEntityClass">
                <argument type="string">%perfico_crm.entity_alias.product%</argument>
            </call>
        </service>

        <service id="perfico_crm.api.product_child_converter" class="Perfico\CRMBundle\Transformer\Converter\ProductChildConverter" parent="perfico_crm.api.entity_converter">
            <call method="setEntityClass">
                <argument type="string">%perfico_crm.entity_alias.product%</argument>
            </call>
            <call method="setProductManager">
                <argument type="service" id="perfico_crm.product_manager"/>
            </call>
        </service>

        <service id="perfico_crm.api.user_converter" class="Perfico\CRMBundle\Transformer\Converter\UserConverter" parent="perfico_crm.api.entity_converter">
            <call method="setEntityClass">
                <argument type="string">%perfico_crm.entity_alias.user%</argument>
            </call>
        </service>

        <service id="perfico_crm.api.group_converter" class="Perfico\CRMBundle\Transformer\Converter\GroupConverter" parent="perfico_crm.api.entity_converter">
            <call method="setEntityClass">
                <argument type="string">%perfico_crm.entity_alias.group%</argument>
            </call>
        </service>

        <service id="perfico_crm.safe_doctrine_param_converter" class="Perfico\CRMBundle\Request\ParamConverter\SafeDoctrineParamConverter">
            <argument type="service" id="doctrine"/>
            <argument type="service" id="perfico_crm.account_manager"/>
            <tag name="request.param_converter" converter="safe.doctrine.orm"/>
        </service>

    </services>

</container>